---
platform: linux

image_resource:
  type: docker-image
  source:
    repository: mumoshu/dcind

inputs:
  - name: git-repo
  - name: gradle-project
outputs:
  - name: out

run:
  path: sh
  args:
    - -exc
    - |
      source /docker-lib.sh
      start_docker
      cp -r gradle-project git-repo/project
      cd git-repo
      docker-compose run gradle sh -c "cd /tmp/project && gradle test"
      cp -r project/build ../out

